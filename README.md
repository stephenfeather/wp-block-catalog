# WP Block Catalog

This repo builds a versioned catalog of WordPress blocks for use by automated systems (e.g. AI agents) that need to generate Gutenberg‑serialized HTML safely and consistently.

## Outputs
- `artifacts/wp-6.9.1-core-blocks.json` — machine‑readable block metadata
- `artifacts/wp-6.9.1-core-blocks.csv` — summary CSV
- `artifacts/wp-6.9.1-core-block-examples.json` — canonical example markup (optional)
- `artifacts/wp-6.9.1-runtime-blocks.json` — runtime registry block metadata
- `artifacts/wp-6.9.1-runtime-blocks-associated.json` — runtime blocks with plugin associations
- `docs/wp-6.9.1-core-blocks.md` — core catalog
- `docs/wp-6.9.1-plugin-blocks.md` — plugin catalog (block.json scan)
- `docs/wp-6.9.1-runtime-blocks.md` — runtime catalog
- `docs/{plugin}-{version}-blocks.md` — per‑plugin runtime catalogs (e.g. `docs/elementor-pro-3.34.0-blocks.md`)

## Build the Catalog (metadata only)
This path does not require a WordPress runtime.

```bash
python3 /Users/stephenfeather/Development/wp-block-catalog/scripts/build_blocks_catalog.py \
  --wp-version 6.9.1 \
  --download
```

### Split by origin (core vs plugins vs themes)
```bash
python3 /Users/stephenfeather/Development/wp-block-catalog/scripts/build_blocks_catalog.py \
  --wp-version 6.9.1 \
  --download \
  --include-plugins \
  --split-by-origin \
  --plugin-filter woocommerce
```

## Generate Example Markup (optional)
Example markup is generated by running a small PHP script *inside* a WordPress runtime, so the output matches the actual serialization rules for that version.

Why inside WP:
- Block types are registered during WP bootstrap.
- `serialize_block()` is only available after WordPress loads.
- It guarantees canonical output for that version.

### Docker runtime (recommended)
Uses a high port (`9876`) to avoid collisions.

```bash
docker compose up -d

docker compose exec wpcli wp core install \
  --url=http://localhost:9876 \
  --title=BlockCatalog \
  --admin_user=admin \
  --admin_password=admin \
  --admin_email=admin@example.com

docker compose exec wpcli php /workspace/scripts/generate_block_examples.php \
  --wp-root=/var/www/html \
  --out=/workspace/artifacts/wp-6.9.1-core-block-examples.json
```

### Merge examples into docs
```bash
python3 /Users/stephenfeather/Development/wp-block-catalog/scripts/build_blocks_catalog.py \
  --wp-version 6.9.1 \
  --download \
  --examples-json /Users/stephenfeather/Development/wp-block-catalog/artifacts/wp-6.9.1-core-block-examples.json
```

## Custom Blocks (plugins/themes)
When you’re ready to include plugin or theme blocks:

```bash
python3 /Users/stephenfeather/Development/wp-block-catalog/scripts/build_blocks_catalog.py \
  --wp-version 6.9.1 \
  --download \
  --include-plugins \
  --include-themes \
  --split-by-origin
```

You can also add custom scan roots:
```bash
python3 /Users/stephenfeather/Development/wp-block-catalog/scripts/build_blocks_catalog.py \
  --wp-version 6.9.1 \
  --download \
  --extra-root /path/to/custom/blocks \
  --source-label custom
```

## Notes
- The example generator uses `blockType->example` when available; otherwise it emits a minimal serialized block.
- Dynamic blocks are marked in the catalog; example markup may be minimal unless the block provides an example.
